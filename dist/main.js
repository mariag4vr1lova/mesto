(()=>{"use strict";const e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),s={form:"popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},i=document.forms.formCards,o={},n=class{constructor(e){this._popup=document.querySelector(e),this._popupCloseButtons=this._popup.querySelector(".popup__button-close")}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleCloseButtons=()=>{this.close()};_handleClickByOverlay=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._popupCloseButtons.addEventListener("click",this._handleCloseButtons),this._popup.addEventListener("click",this._handleClickByOverlay)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},r=class extends n{constructor(e,t){super(e),this._submitFunction=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}getInputValues(){return this._values={},this._inputList.forEach((e=>{this._values[e.name]=e.value})),this._values}setInputsValue(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._submitFunction)}close(){super.close(),this._form.reset()}},l=new class{constructor(e){this._profileName=document.querySelector(e.profileNameSelector),this._profileDescription=document.querySelector(e.profileDescriptionSelector)}getUserInfo(){return{username:this._profileName.textContent,subtitle:this._profileDescription.textContent}}setUserInfo(e){this._profileName.textContent=e.username,this._profileDescription.textContent=e.subtitle}}({profileNameSelector:".profile__title",profileDescriptionSelector:".profile__subtitle"}),a=new class extends n{constructor(e){super(e),this._zoomImage=this._popup.querySelector(".popup__zoom-image"),this._zoomTitle=this._popup.querySelector(".popup__zoom-title")}open=e=>{this._zoomImage.src=e.link,this._zoomImage.alt=e.title,this._zoomTitle.textContent=e.title,super.open()}}(".popup_zoom_cards"),p=new class{constructor({items:e,renderer:t},s){this._container=document.querySelector(s),this._initialCards=e,this.renderer=t}addCardFormArray(){this._initialCards.forEach((e=>{this.addItem(this.renderer(e))}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Рим",link:"https://rabota-za-granicej.ru/wp-content/uploads/7/7/4/774d0fc2a81b74009771c44d8cd28c23.jpeg"},{title:"Парк Гуэль, Барселона",link:"https://sportishka.com/uploads/posts/2022-04/1650502427_16-sportishka-com-p-dostoprimechatelnosti-barseloni-park-guel-16.jpg"},{title:"Рио-де-Жанейро",link:"https://i.artfile.ru/2048x1365_1342825_[www.ArtFile.ru].jpg"},{title:"Кейптаун",link:"https://storage.googleapis.com/wzukusers/user-34200503/images/5b7660b91af63kKjrEsD/Best-Cape-Town2_hf.jpg"},{title:"Новый Орлеан",link:"https://www.americantravel.ru/files/multifile/835/550/new_orleans_1630343_960_720.jpg"},{title:"Париж",link:"https://vsegda-pomnim.com/uploads/posts/2022-03/1648674879_78-vsegda-pomnim-com-p-reka-sena-v-parizhe-foto-92.jpg"}],renderer:e=>new class{constructor(e,t,s){this._cardData=e,this._title=e.title,this._link=e.link,this._imageTemplate=t,this._openZoomPopup=s}_getTemplateClone(){return document.querySelector(this._imageTemplate).content.querySelector(".element").cloneNode(!0)}_hendleLike=()=>{this._likeElement.classList.toggle("element__like_active")};_handleDeleteButtonElement=()=>{this._cloneElement.remove(),this._cloneElement=null};_handelOpenImage=()=>{this._openZoomPopup(this._cardData)};_setEventListner(){this._likeElement.addEventListener("click",this._hendleLike),this._deleteButtonElement.addEventListener("click",this._handleDeleteButtonElement),this._imageElement.addEventListener("click",this._handelOpenImage)}createCard(){return this._cloneElement=this._getTemplateClone(),this._imageElement=this._cloneElement.querySelector(".element__image"),this._likeElement=this._cloneElement.querySelector(".element__like"),this._titleElement=this._cloneElement.querySelector(".element__title"),this._deleteButtonElement=this._cloneElement.querySelector(".element__delete-button"),this._imageElement.src=this._link,this._imageElement.alt=this._title,this._titleElement.textContent=this._title,this._setEventListner(),this._cloneElement}}(e,"#imageTemplate",a.open).createCard()},".elements");p.addCardFormArray();const u=new r(".popup-profile",(e=>{e.preventDefault(),l.setUserInfo(u.getInputValues()),u.close()})),_=new r(".popup-cards",(e=>{e.preventDefault(),p.addItem(p.renderer(_.getInputValues())),_.close(),e.target.reset()}));Array.from(document.forms).forEach((e=>{const t=new class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._button=t.querySelector(this._submitButtonSelector),this._inputList=t.querySelectorAll(this._inputSelector)}_showInputError(e,t){e.classList.add(this._errorClass),e.textContent=t.validationMessage,t.classList.add(this._inputErrorClass)}_hideInputError(e,t){e.classList.remove(this._errorClass),e.textContent="",t.classList.remove(this._inputErrorClass)}_enableButton(){this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=!1}_disableButton(){this._button.classList.add(this._inactiveButtonClass),this._button.disabled=!0}_checkInputValidity(e){const t=this._form.querySelector(`.${e.id}-error`);e.validity.valid?this._hideInputError(t,e):this._showInputError(t,e)}_hasInvalidInput(){return Array.from(this._inputList).every((e=>e.validity.valid))}_toggleButtonStatus(){this._hasInvalidInput()?this._enableButton():this._disableButton()}_setEventListener(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonStatus()}))}))}enableValidation(){this._setEventListener()}resetValidation(){this._inputList.forEach((e=>{const t=this._form.querySelector(`.${e.id}-error`);this._hideInputError(t,e)})),this._disableButton()}}(s,e),i=e.name;o[i]=t,t.enableValidation()})),a.setEventListeners(),u.setEventListeners(),_.setEventListeners(),e.addEventListener("click",(()=>{o.formProfile.resetValidation(),u.setInputsValue(l.getUserInfo()),u.open()})),t.addEventListener("click",(()=>{i.reset(),o.formCards.resetValidation(),_.open()}))})();